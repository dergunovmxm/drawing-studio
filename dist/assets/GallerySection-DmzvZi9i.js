import{a as D,r,j as n,T as f,b as B,u as P,L as H}from"./index-C7H1vz3L.js";import{u as O,B as W,d as F}from"./description-BBnjlJaG.js";import{u as G}from"./useGroupImage-B5MbCB8D.js";import{B as z}from"./Breadcrumbs-DPuekOiV.js";var $=D();const U="_root_1itdt_1",X="_title_1itdt_11",q="_section_1itdt_15",V="_header_1itdt_37",Z="_content_1itdt_48",Y="_skeletonImage_1itdt_97",x={root:U,title:X,section:q,header:V,content:Z,skeletonImage:Y},K=({children:i})=>{const o=document.getElementById("modal-root");return o?$.createPortal(i,o):null},J="_backdrop_1two1_1",Q="_content_1two1_21",ee="_imageWrapper_1two1_35",te="_mobileImage_1two1_48",se="_close_1two1_79",ne="_caption_1two1_100",oe="_prev_1two1_112",ie="_next_1two1_112",re="_swipeHint_1two1_150",ae="_swipeArrows_1two1_170",le="_arrowRight_1two1_177",h={backdrop:J,content:Q,imageWrapper:ee,mobileImage:te,close:se,caption:ne,prev:oe,next:ie,swipeHint:re,swipeArrows:ae,arrowRight:le};/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var k=function(i,o){return k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])},k(i,o)};function ce(i,o){k(i,o);function e(){this.constructor=i}i.prototype=o===null?Object.create(o):(e.prototype=o.prototype,new e)}function de(i,o){o===void 0&&(o={});var e=o.insertAt;if(!(typeof document>"u")){var t=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",e==="top"&&t.firstChild?t.insertBefore(s,t.firstChild):t.appendChild(s),s.styleSheet?s.styleSheet.cssText=i:s.appendChild(document.createTextNode(i))}}var he=`.styles_container__2pRR5 {
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
  padding: 8px;
}

.styles_container__2pRR5:hover .styles_magnifying-glass__12Z9V {
  opacity: 1;
}

.styles_magnifying-glass__12Z9V {
  z-index: 10;
  position: absolute;
  background-repeat: no-repeat;
  background-color: white;
  border-style: solid;
  border-radius: 50%;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.5s ease-in-out;
}`,R={container:"styles_container__2pRR5","magnifying-glass":"styles_magnifying-glass__12Z9V"};de(he);var M;(function(i){i.NONE="none",i.NORMAL="normal"})(M||(M={}));var ue=(function(i){ce(o,i);function o(e){var t=i.call(this,e)||this;return t.touchMoveListenerAdded=!1,t.handleMouseMove=function(s){s.preventDefault();var d=s.type==="touchmove"||s.type==="touchstart";t.handleImagePosition(s,d)},t.handleTouchStart=t.handleTouchStart.bind(t),t.handleTouchEnd=t.handleTouchEnd.bind(t),t}return o.prototype.componentDidMount=function(){this.imgEl.addEventListener("mousemove",this.handleMouseMove),this.imgEl.addEventListener("touchstart",this.handleTouchStart),this.imgEl.addEventListener("touchend",this.handleTouchEnd),this.setGlassStyles()},o.prototype.componentWillUnmount=function(){this.imgEl.removeEventListener("mousemove",this.handleMouseMove),this.imgEl.removeEventListener("touchmove",this.handleMouseMove),this.imgEl.removeEventListener("touchstart",this.handleTouchStart),this.imgEl.removeEventListener("touchend",this.handleTouchEnd)},o.prototype.render=function(){var e=this;return r.createElement("div",{className:R.container},r.createElement("img",{src:this.props.imageUrl,alt:this.props.imgAlt,ref:function(t){e.imgEl=t}}),r.createElement("div",{className:R["magnifying-glass"],ref:function(t){e.glass=t}}))},o.prototype.removeGlass=function(){var e=this;window.requestAnimationFrame(function(){e.imgEl.style.cursor=M.NORMAL})},o.prototype.handleImagePosition=function(e,t){var s=this;t===void 0&&(t=!1);var d=t?e.targetTouches[0].target:e.target;if(d!==this.imgEl){this.removeGlass();return}window.requestAnimationFrame(function(){var l={x:t?e.targetTouches[0].pageX:e.pageX,y:t?e.targetTouches[0].pageY:e.pageY},u=s.imgEl.getBoundingClientRect(),m=s.glass.offsetWidth/2,p=s.props.zoomFactor*(l.x-u.left)-m,v=s.props.zoomFactor*(l.y-u.top)-m;s.imgEl.style.cursor=M.NONE,s.glass.style.left=l.x-m+"px",s.glass.style.top=l.y-m+"px",s.glass.style.backgroundPosition=-p+"px "+-v+"px",s.glass.style.backgroundSize=s.props.zoomFactor*u.width+"px "+s.props.zoomFactor*u.height+"px"})},o.prototype.handleTouchEnd=function(e){e.preventDefault(),this.imgEl.removeEventListener("touchmove",this.handleMouseMove),this.touchMoveListenerAdded=!1,this.removeGlass(),this.glass.style.opacity="0"},o.prototype.handleTouchStart=function(e){if(e.preventDefault(),this.touchMoveListenerAdded&&(this.imgEl.removeEventListener("touchmove",this.handleMouseMove),this.touchMoveListenerAdded=!1),e.targetTouches[0].target!==this.imgEl){this.removeGlass(),this.glass.style.opacity="0";return}this.glass.style.opacity="1",this.imgEl.addEventListener("touchmove",this.handleMouseMove),this.touchMoveListenerAdded=!0},o.prototype.setGlassStyles=function(){this.glass.style.backgroundImage='url("'+this.props.largeImageUrl+'")',this.glass.style.height=(this.props.glassDimension||150)+"px",this.glass.style.width=(this.props.glassDimension||150)+"px",this.glass.style.borderColor=this.props.glassBorderColor||"#be9a35",this.glass.style.borderWidth=(this.props.glassBorderWidth||8)+"px"},o})(r.PureComponent);const me=({open:i,onClose:o,images:e=[],index:t=0,onChangeIndex:s})=>{const d=Math.max(0,Math.min(t,e.length-1)),l=e[d],[u,m]=r.useState(null),[p,v]=r.useState(null),[w,E]=r.useState(!1),b=r.useRef(null),j=50,y=r.useCallback(c=>{if(!s)return;const _=(c%e.length+e.length)%e.length;s(_)},[e.length,s]),a=r.useCallback(()=>{e.length!==0&&y(d+1)},[e.length,d,y]),g=r.useCallback(()=>{e.length!==0&&y(d-1)},[e.length,d,y]),N=c=>{v(null),m(c.targetTouches[0].clientX)},L=c=>{v(c.targetTouches[0].clientX)},I=()=>{if(!u||!p)return;const c=u-p,_=c>j,A=c<-j;_?a():A&&g()};if(r.useEffect(()=>{if(!i)return;const c=T=>{if(T.key==="Escape")return o?.();if(T.key==="ArrowRight")return a();if(T.key==="ArrowLeft")return g()};document.addEventListener("keydown",c);const _=document.body.style.overflow;if(document.body.style.overflow="hidden",typeof window<"u"&&window.innerWidth<=480&&e.length>1&&!(localStorage.getItem("imageDetailSwipeHintSeen")==="true")){E(!0),localStorage.setItem("imageDetailSwipeHintSeen","true");const C=setTimeout(()=>{E(!1)},3e3);return()=>{document.removeEventListener("keydown",c),document.body.style.overflow=_,clearTimeout(C)}}return()=>{document.removeEventListener("keydown",c),document.body.style.overflow=_}},[i,o,a,g,e.length]),r.useEffect(()=>{i||localStorage.removeItem("imageDetailSwipeHintSeen")},[i]),!i||!l)return null;const S=typeof window<"u"&&window.innerWidth<=480;return n.jsx(K,{children:n.jsxs("div",{className:h.backdrop,onMouseDown:o,role:"dialog","aria-modal":"true",children:[n.jsx("button",{className:h.close,"aria-label":"Close",onClick:o,children:"×"}),n.jsxs("div",{className:h.content,onMouseDown:c=>c.stopPropagation(),ref:b,...S&&{onTouchStart:N,onTouchMove:L,onTouchEnd:I},children:[n.jsxs("div",{className:h.imageWrapper,children:[n.jsx(ue,{imageUrl:l.link,largeImageUrl:l.link,zoomFactor:2,glassDimension:250,glassBorderColor:"#000000cc",glassBorderWidth:2},l.link),n.jsx("img",{className:h.mobileImage,src:l.link,alt:"image",...S&&{onTouchStart:N,onTouchMove:L,onTouchEnd:I}})]}),S&&e.length>1&&w&&n.jsxs("div",{className:h.swipeHint,children:[n.jsx("div",{className:h.swipeArrows,children:n.jsx("span",{className:h.arrowRight,children:"›››"})}),n.jsx(f,{name:"caption3",text:"Свайп для просмотра картинок"})]}),!S&&n.jsxs(n.Fragment,{children:[n.jsx("button",{className:h.prev,"aria-label":"Previous",onClick:g,type:"button",children:"‹"}),n.jsx("button",{className:h.next,"aria-label":"Next",onClick:a,type:"button",children:"›"})]}),l.title&&n.jsx("div",{className:h.caption,children:l.title&&n.jsx(f,{className:h.title,name:"caption6",text:l.title})})]})]})})},ye=()=>{const{alias:i}=B(),o=P(),{data:e,isLoading:t,error:s}=O(),{grouped:d,aliasNames:l}=G(e??[]),u=r.useMemo(()=>d.find(a=>a.alias===i),[d,i]),[m,p]=r.useState(!1),[v,w]=r.useState(0),[E,b]=r.useState(!0);r.useEffect(()=>{window.scrollTo(0,0),b(!0);const a=setTimeout(()=>b(!1),500);return()=>clearTimeout(a)},[i]);const j=a=>{w(a),p(!0)},y=()=>p(!1);return t?n.jsx(H,{}):s?n.jsx(Error,{error:s.message}):u?n.jsxs("main",{className:x.root,children:[n.jsx(z,{items:[{label:"Главная",href:"/"},{label:"Галерея",href:"/gallery"},{label:`${l[i]}`,href:`/gallery/${i}`}],separator:"|"}),n.jsx(f,{name:"title2_secondary",text:"Галерея",className:x.title}),n.jsx("div",{className:x.section,children:n.jsx(f,{name:"caption3_secondary_italic",text:F[i]})}),n.jsx("div",{className:x.header,children:n.jsx(f,{name:"title2_secondary",text:`"${l[i]}"`})}),n.jsx("div",{className:x.content,children:E?[1,2,3,4,5,6].map(a=>n.jsx("div",{className:x.skeletonImage},a)):u.items.map((a,g)=>n.jsx("div",{onClick:()=>{j(g),window.scrollTo(0,0)},children:n.jsx("img",{src:a.link,alt:a.name})},g))}),n.jsx(me,{open:m,onClose:y,images:u.items.filter(Boolean),index:v,onChangeIndex:a=>w(a)})]}):n.jsxs("div",{children:[n.jsx(f,{name:"title3",text:"Раздел не найден"}),n.jsx(W,{variant:"ghost",onClick:()=>o("/gallery"),children:n.jsx(f,{name:"caption2",text:"Вернуться"})})]})};export{ye as default};
