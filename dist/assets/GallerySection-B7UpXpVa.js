import{a as q,r as l,j as o,T as _,b as I,u as C,L as A}from"./index-botEPokd.js";import{u as R,B,d as D}from"./description-BAnK5vB1.js";import{u as P}from"./useGroupImage-DfoksN79.js";import{B as O}from"./Breadcrumbs-BvJyt6r8.js";var W=q();const F="_root_1itdt_1",G="_title_1itdt_11",z="_section_1itdt_15",$="_header_1itdt_37",U="_content_1itdt_48",X="_skeletonImage_1itdt_97",v={root:F,title:G,section:z,header:$,content:U,skeletonImage:X},V=({children:i})=>{const n=document.getElementById("modal-root");return n?W.createPortal(i,n):null},Z="_backdrop_1q36q_1",Y="_content_1q36q_21",K="_imageWrapper_1q36q_34",H="_mobileImage_1q36q_47",J="_close_1q36q_78",Q="_caption_1q36q_99",ee="_prev_1q36q_111",te="_next_1q36q_111",u={backdrop:Z,content:Y,imageWrapper:K,mobileImage:H,close:J,caption:Q,prev:ee,next:te};/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var M=function(i,n){return M=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])},M(i,n)};function se(i,n){M(i,n);function e(){this.constructor=i}i.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}function ne(i,n){n===void 0&&(n={});var e=n.insertAt;if(!(typeof document>"u")){var t=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",e==="top"&&t.firstChild?t.insertBefore(s,t.firstChild):t.appendChild(s),s.styleSheet?s.styleSheet.cssText=i:s.appendChild(document.createTextNode(i))}}var oe=`.styles_container__2pRR5 {
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
  padding: 8px;
}

.styles_container__2pRR5:hover .styles_magnifying-glass__12Z9V {
  opacity: 1;
}

.styles_magnifying-glass__12Z9V {
  z-index: 10;
  position: absolute;
  background-repeat: no-repeat;
  background-color: white;
  border-style: solid;
  border-radius: 50%;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.5s ease-in-out;
}`,N={container:"styles_container__2pRR5","magnifying-glass":"styles_magnifying-glass__12Z9V"};ne(oe);var k;(function(i){i.NONE="none",i.NORMAL="normal"})(k||(k={}));var ie=(function(i){se(n,i);function n(e){var t=i.call(this,e)||this;return t.touchMoveListenerAdded=!1,t.handleMouseMove=function(s){s.preventDefault();var d=s.type==="touchmove"||s.type==="touchstart";t.handleImagePosition(s,d)},t.handleTouchStart=t.handleTouchStart.bind(t),t.handleTouchEnd=t.handleTouchEnd.bind(t),t}return n.prototype.componentDidMount=function(){this.imgEl.addEventListener("mousemove",this.handleMouseMove),this.imgEl.addEventListener("touchstart",this.handleTouchStart),this.imgEl.addEventListener("touchend",this.handleTouchEnd),this.setGlassStyles()},n.prototype.componentWillUnmount=function(){this.imgEl.removeEventListener("mousemove",this.handleMouseMove),this.imgEl.removeEventListener("touchmove",this.handleMouseMove),this.imgEl.removeEventListener("touchstart",this.handleTouchStart),this.imgEl.removeEventListener("touchend",this.handleTouchEnd)},n.prototype.render=function(){var e=this;return l.createElement("div",{className:N.container},l.createElement("img",{src:this.props.imageUrl,alt:this.props.imgAlt,ref:function(t){e.imgEl=t}}),l.createElement("div",{className:N["magnifying-glass"],ref:function(t){e.glass=t}}))},n.prototype.removeGlass=function(){var e=this;window.requestAnimationFrame(function(){e.imgEl.style.cursor=k.NORMAL})},n.prototype.handleImagePosition=function(e,t){var s=this;t===void 0&&(t=!1);var d=t?e.targetTouches[0].target:e.target;if(d!==this.imgEl){this.removeGlass();return}window.requestAnimationFrame(function(){var a={x:t?e.targetTouches[0].pageX:e.pageX,y:t?e.targetTouches[0].pageY:e.pageY},h=s.imgEl.getBoundingClientRect(),m=s.glass.offsetWidth/2,p=s.props.zoomFactor*(a.x-h.left)-m,g=s.props.zoomFactor*(a.y-h.top)-m;s.imgEl.style.cursor=k.NONE,s.glass.style.left=a.x-m+"px",s.glass.style.top=a.y-m+"px",s.glass.style.backgroundPosition=-p+"px "+-g+"px",s.glass.style.backgroundSize=s.props.zoomFactor*h.width+"px "+s.props.zoomFactor*h.height+"px"})},n.prototype.handleTouchEnd=function(e){e.preventDefault(),this.imgEl.removeEventListener("touchmove",this.handleMouseMove),this.touchMoveListenerAdded=!1,this.removeGlass(),this.glass.style.opacity="0"},n.prototype.handleTouchStart=function(e){if(e.preventDefault(),this.touchMoveListenerAdded&&(this.imgEl.removeEventListener("touchmove",this.handleMouseMove),this.touchMoveListenerAdded=!1),e.targetTouches[0].target!==this.imgEl){this.removeGlass(),this.glass.style.opacity="0";return}this.glass.style.opacity="1",this.imgEl.addEventListener("touchmove",this.handleMouseMove),this.touchMoveListenerAdded=!0},n.prototype.setGlassStyles=function(){this.glass.style.backgroundImage='url("'+this.props.largeImageUrl+'")',this.glass.style.height=(this.props.glassDimension||150)+"px",this.glass.style.width=(this.props.glassDimension||150)+"px",this.glass.style.borderColor=this.props.glassBorderColor||"#be9a35",this.glass.style.borderWidth=(this.props.glassBorderWidth||8)+"px"},n})(l.PureComponent);const re=({open:i,onClose:n,images:e=[],index:t=0,onChangeIndex:s})=>{const d=Math.max(0,Math.min(t,e.length-1)),a=e[d],[h,m]=l.useState(null),[p,g]=l.useState(null),j=l.useRef(null),T=50,x=typeof window<"u"&&window.innerWidth<=480,f=l.useCallback(c=>{if(!s)return;const E=(c%e.length+e.length)%e.length;s(E)},[e.length,s]),y=l.useCallback(()=>{e.length!==0&&f(d+1)},[e.length,d,f]),r=l.useCallback(()=>{e.length!==0&&f(d-1)},[e.length,d,f]),w=c=>{g(null),m(c.targetTouches[0].clientX)},L=c=>{g(c.targetTouches[0].clientX)},S=()=>{if(!h||!p)return;const c=h-p,E=c>T,b=c<-T;E?y():b&&r()};return l.useEffect(()=>{if(!i)return;const c=b=>{if(b.key==="Escape")return n?.();if(b.key==="ArrowRight")return y();if(b.key==="ArrowLeft")return r()};document.addEventListener("keydown",c);const E=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",c),document.body.style.overflow=E}},[i,n,y,r]),!i||!a?null:o.jsx(V,{children:o.jsx("div",{className:u.backdrop,onMouseDown:n,role:"dialog","aria-modal":"true",children:o.jsxs("div",{className:u.content,onMouseDown:c=>c.stopPropagation(),ref:j,...x&&{onTouchStart:w,onTouchMove:L,onTouchEnd:S},children:[o.jsxs("div",{className:u.imageWrapper,children:[o.jsx(ie,{imageUrl:a.link,largeImageUrl:a.link,zoomFactor:2,glassDimension:250,glassBorderColor:"#000000cc",glassBorderWidth:2},a.link),o.jsx("img",{className:u.mobileImage,src:a.link,alt:"image"})]}),o.jsx("button",{className:u.close,"aria-label":"Close",onClick:n,children:"×"}),!x&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:u.prev,"aria-label":"Previous",onClick:r,type:"button",children:"‹"}),o.jsx("button",{className:u.next,"aria-label":"Next",onClick:y,type:"button",children:"›"})]}),a.title&&o.jsx("div",{className:u.caption,children:a.title&&o.jsx(_,{className:u.title,name:"caption6",text:a.title})})]})})})},he=()=>{const{alias:i}=I(),n=C(),{data:e,isLoading:t,error:s}=R(),{grouped:d,aliasNames:a}=P(e??[]),h=l.useMemo(()=>d.find(r=>r.alias===i),[d,i]),[m,p]=l.useState(!1),[g,j]=l.useState(0),[T,x]=l.useState(!0);l.useEffect(()=>{window.scrollTo(0,0),x(!0);const r=setTimeout(()=>x(!1),500);return()=>clearTimeout(r)},[i]);const f=r=>{j(r),p(!0)},y=()=>p(!1);return t?o.jsx(A,{}):s?o.jsx(Error,{error:s.message}):h?o.jsxs("main",{className:v.root,children:[o.jsx(O,{items:[{label:"Главная",href:"/"},{label:"Галерея",href:"/gallery"},{label:`${a[i]}`,href:`/gallery/${i}`}],separator:"|"}),o.jsx(_,{name:"title2_secondary",text:"Галерея",className:v.title}),o.jsx("div",{className:v.section,children:o.jsx(_,{name:"caption3_secondary_italic",text:D[i]})}),o.jsx("div",{className:v.header,children:o.jsx(_,{name:"title2_secondary",text:`"${a[i]}"`})}),o.jsx("div",{className:v.content,children:T?[1,2,3,4,5,6].map(r=>o.jsx("div",{className:v.skeletonImage},r)):h.items.map((r,w)=>o.jsx("div",{onClick:()=>{f(w),window.scrollTo(0,0)},children:o.jsx("img",{src:r.link,alt:r.name})},w))}),o.jsx(re,{open:m,onClose:y,images:h.items.filter(Boolean),index:g,onChangeIndex:r=>j(r)})]}):o.jsxs("div",{children:[o.jsx(_,{name:"title3",text:"Раздел не найден"}),o.jsx(B,{variant:"ghost",onClick:()=>n("/gallery"),children:o.jsx(_,{name:"caption2",text:"Вернуться"})})]})};export{he as default};
