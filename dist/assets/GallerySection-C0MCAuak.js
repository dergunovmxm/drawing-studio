import{a as D,r,j as s,T as f,b as B,u as P,L as H}from"./index-Bzjqw8Ms.js";import{u as O,d as W}from"./description-BfJBgN1C.js";import{u as F}from"./useGroupImage-BwquWekR.js";import{B as G}from"./Button-DM7O7tpm.js";import{B as z}from"./Breadcrumbs-CZckqXNj.js";var $=D();const U="_root_1itdt_1",X="_title_1itdt_11",q="_section_1itdt_15",V="_header_1itdt_37",Z="_content_1itdt_48",Y="_skeletonImage_1itdt_97",x={root:U,title:X,section:q,header:V,content:Z,skeletonImage:Y},K=({children:i})=>{const o=document.getElementById("modal-root");return o?$.createPortal(i,o):null},J="_backdrop_kghcv_1",Q="_content_kghcv_21",ee="_imageWrapper_kghcv_28",te="_mobileImage_kghcv_41",se="_close_kghcv_71",ne="_caption_kghcv_92",oe="_prev_kghcv_104",ie="_next_kghcv_104",re="_swipeHint_kghcv_142",ae="_swipeArrows_kghcv_162",le="_arrowLeft_kghcv_169",ce="_arrowRight_kghcv_169",d={backdrop:J,content:Q,imageWrapper:ee,mobileImage:te,close:se,caption:ne,prev:oe,next:ie,swipeHint:re,swipeArrows:ae,arrowLeft:le,arrowRight:ce};/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var M=function(i,o){return M=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},M(i,o)};function de(i,o){M(i,o);function e(){this.constructor=i}i.prototype=o===null?Object.create(o):(e.prototype=o.prototype,new e)}function he(i,o){o===void 0&&(o={});var e=o.insertAt;if(!(typeof document>"u")){var t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",e==="top"&&t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n),n.styleSheet?n.styleSheet.cssText=i:n.appendChild(document.createTextNode(i))}}var ue=`.styles_container__2pRR5 {
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
  padding: 8px;
}

.styles_container__2pRR5:hover .styles_magnifying-glass__12Z9V {
  opacity: 1;
}

.styles_magnifying-glass__12Z9V {
  z-index: 10;
  position: absolute;
  background-repeat: no-repeat;
  background-color: white;
  border-style: solid;
  border-radius: 50%;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.5s ease-in-out;
}`,R={container:"styles_container__2pRR5","magnifying-glass":"styles_magnifying-glass__12Z9V"};he(ue);var T;(function(i){i.NONE="none",i.NORMAL="normal"})(T||(T={}));var me=(function(i){de(o,i);function o(e){var t=i.call(this,e)||this;return t.touchMoveListenerAdded=!1,t.handleMouseMove=function(n){n.preventDefault();var h=n.type==="touchmove"||n.type==="touchstart";t.handleImagePosition(n,h)},t.handleTouchStart=t.handleTouchStart.bind(t),t.handleTouchEnd=t.handleTouchEnd.bind(t),t}return o.prototype.componentDidMount=function(){this.imgEl.addEventListener("mousemove",this.handleMouseMove),this.imgEl.addEventListener("touchstart",this.handleTouchStart),this.imgEl.addEventListener("touchend",this.handleTouchEnd),this.setGlassStyles()},o.prototype.componentWillUnmount=function(){this.imgEl.removeEventListener("mousemove",this.handleMouseMove),this.imgEl.removeEventListener("touchmove",this.handleMouseMove),this.imgEl.removeEventListener("touchstart",this.handleTouchStart),this.imgEl.removeEventListener("touchend",this.handleTouchEnd)},o.prototype.render=function(){var e=this;return r.createElement("div",{className:R.container},r.createElement("img",{src:this.props.imageUrl,alt:this.props.imgAlt,ref:function(t){e.imgEl=t}}),r.createElement("div",{className:R["magnifying-glass"],ref:function(t){e.glass=t}}))},o.prototype.removeGlass=function(){var e=this;window.requestAnimationFrame(function(){e.imgEl.style.cursor=T.NORMAL})},o.prototype.handleImagePosition=function(e,t){var n=this;t===void 0&&(t=!1);var h=t?e.targetTouches[0].target:e.target;if(h!==this.imgEl){this.removeGlass();return}window.requestAnimationFrame(function(){var l={x:t?e.targetTouches[0].pageX:e.pageX,y:t?e.targetTouches[0].pageY:e.pageY},u=n.imgEl.getBoundingClientRect(),m=n.glass.offsetWidth/2,p=n.props.zoomFactor*(l.x-u.left)-m,v=n.props.zoomFactor*(l.y-u.top)-m;n.imgEl.style.cursor=T.NONE,n.glass.style.left=l.x-m+"px",n.glass.style.top=l.y-m+"px",n.glass.style.backgroundPosition=-p+"px "+-v+"px",n.glass.style.backgroundSize=n.props.zoomFactor*u.width+"px "+n.props.zoomFactor*u.height+"px"})},o.prototype.handleTouchEnd=function(e){e.preventDefault(),this.imgEl.removeEventListener("touchmove",this.handleMouseMove),this.touchMoveListenerAdded=!1,this.removeGlass(),this.glass.style.opacity="0"},o.prototype.handleTouchStart=function(e){if(e.preventDefault(),this.touchMoveListenerAdded&&(this.imgEl.removeEventListener("touchmove",this.handleMouseMove),this.touchMoveListenerAdded=!1),e.targetTouches[0].target!==this.imgEl){this.removeGlass(),this.glass.style.opacity="0";return}this.glass.style.opacity="1",this.imgEl.addEventListener("touchmove",this.handleMouseMove),this.touchMoveListenerAdded=!0},o.prototype.setGlassStyles=function(){this.glass.style.backgroundImage='url("'+this.props.largeImageUrl+'")',this.glass.style.height=(this.props.glassDimension||150)+"px",this.glass.style.width=(this.props.glassDimension||150)+"px",this.glass.style.borderColor=this.props.glassBorderColor||"#be9a35",this.glass.style.borderWidth=(this.props.glassBorderWidth||8)+"px"},o})(r.PureComponent);const pe=({open:i,onClose:o,images:e=[],index:t=0,onChangeIndex:n})=>{const h=Math.max(0,Math.min(t,e.length-1)),l=e[h],[u,m]=r.useState(null),[p,v]=r.useState(null),[w,E]=r.useState(!1),k=r.useRef(null),b=50,y=typeof window<"u"&&window.innerWidth<=480,a=r.useCallback(c=>{if(!n)return;const _=(c%e.length+e.length)%e.length;n(_)},[e.length,n]),g=r.useCallback(()=>{e.length!==0&&a(h+1)},[e.length,h,a]),j=r.useCallback(()=>{e.length!==0&&a(h-1)},[e.length,h,a]),N=c=>{v(null),m(c.targetTouches[0].clientX)},L=c=>{v(c.targetTouches[0].clientX)},I=()=>{if(!u||!p)return;const c=u-p,_=c>b,A=c<-b;_?g():A&&j()};return r.useEffect(()=>{if(!i)return;const c=S=>{if(S.key==="Escape")return o?.();if(S.key==="ArrowRight")return g();if(S.key==="ArrowLeft")return j()};document.addEventListener("keydown",c);const _=document.body.style.overflow;if(document.body.style.overflow="hidden",typeof window<"u"&&window.innerWidth<=480&&e.length>1&&!(localStorage.getItem("imageDetailSwipeHintSeen")==="true")){E(!0),localStorage.setItem("imageDetailSwipeHintSeen","true");const C=setTimeout(()=>{E(!1)},3e3);return()=>{document.removeEventListener("keydown",c),document.body.style.overflow=_,clearTimeout(C)}}return()=>{document.removeEventListener("keydown",c),document.body.style.overflow=_}},[i,o,g,j,e.length]),r.useEffect(()=>{i||localStorage.removeItem("imageDetailSwipeHintSeen")},[i]),!i||!l?null:s.jsx(K,{children:s.jsxs("div",{className:d.backdrop,onMouseDown:o,role:"dialog","aria-modal":"true",children:[s.jsx("button",{className:d.close,"aria-label":"Close",onClick:o,children:"×"}),s.jsxs("div",{className:d.content,onMouseDown:c=>c.stopPropagation(),ref:k,...y&&{onTouchStart:N,onTouchMove:L,onTouchEnd:I},children:[s.jsxs("div",{className:d.imageWrapper,children:[s.jsx(me,{imageUrl:l.link,largeImageUrl:l.link,zoomFactor:2,glassDimension:250,glassBorderColor:"#000000cc",glassBorderWidth:2},l.link),s.jsx("img",{className:d.mobileImage,src:l.link,alt:"image",...y&&{onTouchStart:N,onTouchMove:L,onTouchEnd:I}})]}),y&&e.length>1&&w&&s.jsxs("div",{className:d.swipeHint,children:[s.jsxs("div",{className:d.swipeArrows,children:[s.jsx("span",{className:d.arrowLeft,children:"‹‹‹"}),s.jsx("span",{className:d.arrowRight,children:"›››"})]}),s.jsx(f,{name:"caption3",text:"Свайп для переключения картинок"})]}),y?null:s.jsxs(s.Fragment,{children:[s.jsx("button",{className:d.prev,"aria-label":"Previous",onClick:j,type:"button",children:"‹"}),s.jsx("button",{className:d.next,"aria-label":"Next",onClick:g,type:"button",children:"›"})]}),l.title&&s.jsx("div",{className:d.caption,children:l.title&&s.jsx(f,{className:d.title,name:"caption6",text:l.title})})]})]})})},xe=()=>{const{alias:i}=B(),o=P(),{data:e,isLoading:t,error:n}=O(),{grouped:h,aliasNames:l}=F(e??[]),u=r.useMemo(()=>h.find(a=>a.alias===i),[h,i]),[m,p]=r.useState(!1),[v,w]=r.useState(0),[E,k]=r.useState(!0);r.useEffect(()=>{window.scrollTo(0,0),k(!0);const a=setTimeout(()=>k(!1),500);return()=>clearTimeout(a)},[i]);const b=a=>{w(a),p(!0)},y=()=>p(!1);return t?s.jsx(H,{}):n?s.jsx(Error,{error:n.message}):u?s.jsxs("main",{className:x.root,children:[s.jsx(z,{items:[{label:"Главная",href:"/"},{label:"Галерея",href:"/gallery"},{label:`${l[i]}`,href:`/gallery/${i}`}],separator:"|"}),s.jsx(f,{name:"title2_secondary",text:"Галерея",className:x.title}),s.jsx("div",{className:x.section,children:s.jsx(f,{name:"caption3_secondary_italic",text:W[i]})}),s.jsx("div",{className:x.header,children:s.jsx(f,{name:"title2_secondary",text:`"${l[i]}"`})}),s.jsx("div",{className:x.content,children:E?[1,2,3,4,5,6].map(a=>s.jsx("div",{className:x.skeletonImage},a)):u.items.map((a,g)=>s.jsx("div",{onClick:()=>{b(g),window.scrollTo(0,0)},children:s.jsx("img",{src:a.link,alt:a.name})},g))}),s.jsx(pe,{open:m,onClose:y,images:u.items.filter(Boolean),index:v,onChangeIndex:a=>w(a)})]}):s.jsxs("div",{children:[s.jsx(f,{name:"title3",text:"Раздел не найден"}),s.jsx(G,{variant:"ghost",onClick:()=>o("/gallery"),children:s.jsx(f,{name:"caption2",text:"Вернуться"})})]})};export{xe as default};
